<!-- âœ… NgbNav Tabs -->
<ul ngbNav #nav="ngbNav" class="nav nav-tabs" data-theme="graphite">
  <li [ngbNavItem]="1">
    <button ngbNavLink>Attendance</button>
    <ng-template ngbNavContent>
      <!-- Attendance Form -->
      <form [formGroup]="_frmGroup">
        <table id="attendanceTable" class="table table-bordered">
          <thead class="table-light">
            <tr>
              <th>Employee ID</th>
              <th>Name</th>
              <th>Date</th>
              <th>InTime</th>
              <th>OutTime</th>
              <th>Status</th>
              <th>Total Time</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <!-- EmpID -->
              <td>
                <input type="text" formControlName="Id" class="form-control" (blur)="onEmployeeIdChange()" />
              </td>

              <!-- Name -->
              <td>
                <input type="text" formControlName="employeeName" class="form-control" readonly />
              </td>

              <!-- Date -->
              <td>
                <input type="date" formControlName="date" class="form-control" readonly />
              </td>

              <!-- InTime -->
              <td>
                <input type="time" formControlName="timeIn" class="form-control" />
              </td>

              <!-- OutTime -->
              <td>
                <input type="time" formControlName="timeOut" class="form-control" />
              </td>

              <!-- Status -->
              <td>
                <div class="form-check">
                  <input class="form-check-input" type="radio" formControlName="status" value="0" id="absentRadio" />
                  <label class="form-check-label" for="absentRadio">Absent</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" formControlName="status" value="1" id="presentRadio" />
                  <label class="form-check-label" for="presentRadio">Present</label>
                </div>
              </td>

              <!-- Total Time -->
              <td>
                <span>
                  {{
                    _frmGroup.value.timeIn && _frmGroup.value.timeOut
                      ? calculateTotalTime(_frmGroup.value.timeIn, _frmGroup.value.timeOut)
                      : '-'
                  }}
                </span>
              </td>
            </tr>
          </tbody>
        </table>

        <div class="text-center mt-3">
          <button type="button" class="btn btn-primary" (click)="save()">Submit</button>
        </div>
      </form>
    </ng-template>
  </li>

  <li [ngbNavItem]="2">
    <button ngbNavLink>Attendance Records</button>
    <ng-template ngbNavContent>
      <h4 class="mt-3">Saved Attendance Records</h4>
      <div class="mb-3">
        <label for="filterDate" class="form-label">Filter by Date:</label>
        <input id="filterDate" type="date" [(ngModel)]="filterDate" class="form-control" />
      </div>

      <table class="table table-striped table-bordered">
        <thead class="table-secondary">
          <tr>
            <th>Employee ID</th>
            <th>Name</th>
            <th>Date</th>
            <th>In Time</th>
            <th>Out Time</th>
            <th>Status</th>
            <th>Total Time</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let att of filteredAttendances">
            <td>{{ att.uid || att.Uid || att.Id }}</td>
            <td>{{ att.unm || att.Unm || att.employeeName }}</td>
            <td>{{ att.dt ? (att.dt | date:'shortDate') : (att.Dt | date:'shortDate') }}</td>
            <td>{{ att.inTime || att.InTime }}</td>
            <td>{{ att.outTime || att.OutTime }}</td>
            <td>{{ att.status == '1' || att.Status == 1 ? 'Present' : 'Absent' }}</td>
            <td>{{ att.totalTime || att.TotalTime }}</td>
          </tr>
          <tr *ngIf="filteredAttendances.length === 0">
            <td colspan="7" class="text-center">No attendance records found.</td>
          </tr>
        </tbody>
      </table>
    </ng-template>
  </li>

  <li [ngbNavItem]="3">
    <button ngbNavLink>Employee Attendance</button>
    <ng-template ngbNavContent>
      <h4 class="mt-3">Check Employee Attendance</h4>
      <div class="row g-3 mb-3">
        <div class="col-md-4">
          <label for="empId" class="form-label">Employee ID</label>
          <input id="empId" type="text" [(ngModel)]="employeeIdFilter" class="form-control" />
        </div>
        <div class="col-md-4">
          <label for="monthFilter" class="form-label">Select Month</label>
          <input id="monthFilter" type="month" [(ngModel)]="monthFilter" class="form-control" />
        </div>
        <div class="col-md-4 d-flex align-items-end">
          <button class="btn btn-success" (click)="filterEmployeeAttendance()">Search</button>
        </div>
      </div>

      <table class="table table-striped table-bordered">
        <thead class="table-secondary">
          <tr>
            <th>Date</th>
            <th>In Time</th>
            <th>Out Time</th>
            <th>Status</th>
            <th>Total Time</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let att of employeeAttendance">
            <td>{{ att.dt ? (att.dt | date:'shortDate') : (att.Dt | date:'shortDate') }}</td>
            <td>{{ att.inTime || att.InTime }}</td>
            <td>{{ att.outTime || att.OutTime }}</td>
            <td>{{ att.status == '1' || att.Status == 1 ? 'Present' : 'Absent' }}</td>
            <td>{{ att.totalTime || att.TotalTime }}</td>
          </tr>
          <tr *ngIf="employeeAttendance.length === 0">
            <td colspan="5" class="text-center">No attendance records found.</td>
          </tr>
        </tbody>
      </table>
    </ng-template>
  </li>
</ul>

<div [ngbNavOutlet]="nav" class="mt-3"></div>
